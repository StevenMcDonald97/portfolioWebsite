{"ast":null,"code":"import _classCallCheck from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";// based on tutorial here: https://codeburst.io/image-uploading-using-react-and-node-to-get-the-images-up-c46ec11a7129\nimport React,{Component}from'react';import axios from'axios';import ImageEditor from\"src/App/admin/imageEditor\";import ErrorBoundary from'src/App/errorBoundary';import{BackButton}from'src/App/admin/helperComponents';import{FaArrowDown}from\"react-icons/fa\";var fs=require('fs');var Contact=/*#__PURE__*/function(_Component){_inherits(Contact,_Component);var _super=_createSuper(Contact);function Contact(props){var _this;_classCallCheck(this,Contact);_this=_super.call(this,props);_this.addImage=function(link,fileName){var urls=_this.state.imgURLs;urls.push(link);_this.setState({imgURLs:urls});var values=_this.state.imageData;values.push({fileName:fileName,title:fileName,date:'',size:'',medium:'',availability:'',price:'',portfolio:'',isChanged:true});_this.setState({imageData:values},function(){if(_this.state.imageData.length===_this.state.selectedFiles.length){_this.setState({filesChosen:true});}});};_this.removeImage=function(index){var files=_this.state.selectedFiles;files.splice(index,1);_this.setState({selectedFiles:files});};_this.state={filesChosen:false,selectedFiles:[],imageData:[],imgURLs:[]};_this.createImages=_this.createImages.bind(_assertThisInitialized(_this));_this.removeImage=_this.removeImage.bind(_assertThisInitialized(_this));_this.rebuild=_this.rebuild.bind(_assertThisInitialized(_this));_this.returnToUpload=_this.returnToUpload.bind(_assertThisInitialized(_this));_this.uploadImages=_this.uploadImages.bind(_assertThisInitialized(_this));_this.returnToUserPanel=_this.returnToUserPanel.bind(_assertThisInitialized(_this));return _this;}_createClass(Contact,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(){if(this.state.filesChosen){return false;}else{return true;}}},{key:\"returnToUserPanel\",value:function returnToUserPanel(){this.props.history.push('/userPanel');}},{key:\"createImages\",value:function createImages(e){var _this2=this;this.setState({selectedFiles:Array.from(e.target.files),iamgeData:[],imgURLs:[]},function(){for(var i=0;i<_this2.state.selectedFiles.length;i++){_this2.addImage(URL.createObjectURL(_this2.state.selectedFiles[i]),_this2.state.selectedFiles[i].name);}});}},{key:\"rebuild\",value:function rebuild(){var fileName='../rebuild.json';var file=require(fileName);file.key=\"rebuild\";fs.writeFile(fileName,JSON.stringify(file),function writeJSON(err){if(err)return console.log(err);});}},{key:\"returnToUpload\",value:function returnToUpload(){this.setState({filesChosen:false});}},{key:\"uploadImages\",value:function uploadImages(images,forceRebuild){var _this3=this;var data=new FormData();for(var x=0;x<this.state.selectedFiles.length;x++){data.append('file',this.state.selectedFiles[x]);}axios.post(\"/upload/uploadImages\",data,{// receive two    parameter endpoint url ,form data\n}).then(function(res){// then print response status\nconsole.log(\"Image upload returned: \".concat(res.statusText));if(res.status===500){alert(\"Uploading these images caused a problem. This is likely because your image size is too large. Image max size is 4mb\");}else{axios.post(\"/upload/storeImagesInDB\",images,{// receive two    parameter endpoint url ,form data\n}).then(function(res){// then print response status\nconsole.log(\"Storing images in database returned: \".concat(res.statusText));if(forceRebuild)_this3.rebuild();}).catch(function(err){return console.log(\"Storing images in database returned the error: \"+err);});}}).catch(function(err){alert(\"Uploading these images caused a problem. This is likely because your image size is too large. Image max size is 4mb\");console.log(\"Uploading images returned the error: \"+err);});}},{key:\"render\",value:function render(){var _this4=this;if(this.state.filesChosen){return/*#__PURE__*/React.createElement(ErrorBoundary,null,/*#__PURE__*/React.createElement(ImageEditor,Object.assign({imageURLs:this.state.imgURLs,images:this.state.imageData,removeImageFromParent:this.removeImage,backPage:function backPage(){return _this4.props.history.push('/userPanel');},returnToUpload:this.returnToUpload,onSubmit:this.uploadImages},this.props)));}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"pageEditor main-upload-container\"},/*#__PURE__*/React.createElement(BackButton,{backPage:this.returnToUserPanel}),/*#__PURE__*/React.createElement(\"div\",{className:\"imageUploadContainer\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"pageHeader\"},\" Upload Image(s) \"),/*#__PURE__*/React.createElement(\"div\",{name:\"imageUploader\",className:\"imageUploader\"},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",className:\"form-control\",onChange:this.createImages,multiple:true})),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"imageUploader\"},\" \",/*#__PURE__*/React.createElement(FaArrowDown,{className:\"uploadArrow\"}))));}}}]);return Contact;}(Component);export{Contact as default};","map":{"version":3,"sources":["/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/src/App/admin/uploadImages.js"],"names":["React","Component","axios","ImageEditor","ErrorBoundary","BackButton","FaArrowDown","fs","require","Contact","props","addImage","link","fileName","urls","state","imgURLs","push","setState","values","imageData","title","date","size","medium","availability","price","portfolio","isChanged","length","selectedFiles","filesChosen","removeImage","index","files","splice","createImages","bind","rebuild","returnToUpload","uploadImages","returnToUserPanel","history","e","Array","from","target","iamgeData","i","URL","createObjectURL","name","file","key","writeFile","JSON","stringify","writeJSON","err","console","log","images","forceRebuild","data","FormData","x","append","post","then","res","statusText","status","alert","catch"],"mappings":"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","sourcesContent":["// based on tutorial here: https://codeburst.io/image-uploading-using-react-and-node-to-get-the-images-up-c46ec11a7129\nimport React, { Component} from 'react';\nimport axios from 'axios';\nimport ImageEditor from \"src/App/admin/imageEditor\";\nimport ErrorBoundary from 'src/App/errorBoundary';\nimport { BackButton } from 'src/App/admin/helperComponents';\nimport {FaArrowDown} from \"react-icons/fa\";\nconst fs = require('fs');\n\nexport default class Contact extends Component {\n  constructor(props) {\n\t\tsuper(props);\n    this.state ={\n      filesChosen:false,\n      selectedFiles: [],\n      imageData:[],\n      imgURLs:[]\n    };\n    this.createImages = this.createImages.bind(this);\n    this.removeImage = this.removeImage.bind(this);\n    this.rebuild=this.rebuild.bind(this);\n    this.returnToUpload=this.returnToUpload.bind(this);\n    this.uploadImages = this.uploadImages.bind(this);\n    this.returnToUserPanel=this.returnToUserPanel.bind(this);\n  }\n\n  shouldComponentUpdate () {\n    if(this.state.filesChosen){\n      return false \n    } else {\n      return true\n    }\n  }\n\n  returnToUserPanel(){\n    this.props.history.push('/userPanel');\n  }\n\n  createImages(e) {\n    this.setState({\n      selectedFiles: Array.from(e.target.files),\n      iamgeData:[],\n      imgURLs:[]\n    }, ()=> { \n      for (let i =0; i<this.state.selectedFiles.length;i++){\n        this.addImage(URL.createObjectURL(this.state.selectedFiles[i]), this.state.selectedFiles[i].name);\n      }\n    });\n  }\n\n  rebuild(){\n    const fileName = '../rebuild.json';\n    const file = require(fileName);\n    file.key = \"rebuild\";\n    fs.writeFile(fileName, JSON.stringify(file), function writeJSON(err) {\n      if (err) return console.log(err);\n    });\n  }\n\n  returnToUpload(){\n    this.setState({filesChosen:false});\n  }\n\n  addImage = (link, fileName) => {\n    let urls=this.state.imgURLs;\n    urls.push(link);\n    this.setState({imgURLs: urls})\n      const values = this.state.imageData;\n      values.push({\n          fileName:fileName,\n          title:fileName,\n          date:'',\n          size:'',\n          medium:'',\n          availability:'',\n          price:'',\n          portfolio:'',\n          isChanged:true,\n        });\n\n      this.setState({imageData:values}, ()=>{\n        if (this.state.imageData.length===this.state.selectedFiles.length) {\n          this.setState({filesChosen:true});\n        }\n      });\n  };\n\n  removeImage = (index) => {\n    let files = this.state.selectedFiles;\n    files.splice(index, 1);\n    this.setState({selectedFiles:files});\n  };\n\n  uploadImages(images, forceRebuild) {\n    const data = new FormData();\n    for(var x = 0; x<this.state.selectedFiles.length; x++) {\n        data.append('file', this.state.selectedFiles[x])\n    }\n\n    axios.post(\"/upload/uploadImages\", data, { \n          // receive two    parameter endpoint url ,form data\n    }).then(res => { // then print response status\n      console.log(`Image upload returned: ${res.statusText}`)\n      if (res.status===500){\n        alert(\"Uploading these images caused a problem. This is likely because your image size is too large. Image max size is 4mb\");\n      } else {\n        axios.post(\"/upload/storeImagesInDB\", images, { \n              // receive two    parameter endpoint url ,form data\n        }).then(res => { // then print response status\n            console.log(`Storing images in database returned: ${res.statusText}`);\n            if (forceRebuild) this.rebuild();\n        }).catch(err => console.log(\"Storing images in database returned the error: \"+err));\n      }\n    }).catch(err => {\n      alert(\"Uploading these images caused a problem. This is likely because your image size is too large. Image max size is 4mb\"); \n      console.log(\"Uploading images returned the error: \"+err)\n    });\n\n  }\n\n  render(){\n    if(this.state.filesChosen)\n    {\n      return(        \n        <ErrorBoundary >\n          <ImageEditor imageURLs={this.state.imgURLs} \n            images={this.state.imageData} \n            removeImageFromParent={this.removeImage} \n            backPage={()=>this.props.history.push('/userPanel')}\n            returnToUpload={this.returnToUpload}\n            onSubmit={this.uploadImages}\n            {...this.props}/>\n        </ErrorBoundary>\n      )\n    } else {\n      return(\n        <div className=\"pageEditor main-upload-container\"> \n          <BackButton backPage={this.returnToUserPanel}/>\n          <div className=\"imageUploadContainer\">\n            <h3 className=\"pageHeader\"> Upload Image(s) </h3>\n            <div name=\"imageUploader\" className=\"imageUploader\">\n                <input type=\"file\" className=\"form-control\" onChange={this.createImages} multiple />\n            </div>\n            <label htmlFor=\"imageUploader\"> <FaArrowDown className=\"uploadArrow\"/></label>\n          </div>\n        </div>\n      )\n    }\n  }\n }\n\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _toConsumableArray from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import axios from'axios';import{BackButton,UploadImage}from'src/App/admin/helperComponents';import{FaTrashAlt}from\"react-icons/fa\";// Font Awesome\nvar ListPageTemplate=/*#__PURE__*/function(_Component){_inherits(ListPageTemplate,_Component);var _super=_createSuper(ListPageTemplate);function ListPageTemplate(props){var _this;_classCallCheck(this,ListPageTemplate);_this=_super.call(this,props);_this.getPageData=function(){if(_this.props.pageId){axios.get('/api/getPage',{params:{pageId:_this.props.pageId,pageType:\"list\"}}).then(function(response){_this.setState({title:response.data.title,type:response.data.type,listObjects:response.data.childObjects,numObjs:response.data.childObjects.length});});}};_this.state={type:_this.props.pageType,title:\"\",numObjs:0,listObjects:[],createPage:_this.props.createPage,deleted:[]};_this.onChange=_this.onChange.bind(_assertThisInitialized(_this));_this.getPageData=_this.getPageData.bind(_assertThisInitialized(_this));_this.addPageObject=_this.addPageObject.bind(_assertThisInitialized(_this));_this.updatePageObject=_this.updatePageObject.bind(_assertThisInitialized(_this));_this.removePageObject=_this.removePageObject.bind(_assertThisInitialized(_this));_this.onSubmit=_this.onSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(ListPageTemplate,[{key:\"onChange\",value:function onChange(event){this.setState(_defineProperty({},event.target.name,event.target.value));}},{key:\"componentDidMount\",value:function componentDidMount(){this.getPageData();}},{key:\"addPageObject\",value:function addPageObject(event){var _this2=this;var values=_toConsumableArray(this.state.listObjects);values.push({\"title\":\"\",\"blurb\":\"\",\"imgName\":\"\",\"description\":\"\",keyValue:new Date().getTime(),num:this.state.numObjs});this.setState({listObjects:values},function(){return _this2.setState({numObjs:_this2.state.numObjs+1});});}},{key:\"updatePageObject\",value:function updatePageObject(index,field,value){var values=_toConsumableArray(this.state.listObjects);values[index][field]=value;this.setState({listObjects:values});}},{key:\"removePageObject\",value:function removePageObject(index){var _this3=this;var values=_toConsumableArray(this.state.listObjects);var deletedObjs=_toConsumableArray(this.state.deleted);deletedObjs.push(values[index]._id);values.splice(index,1);for(var i=index;i<values.length;i++){values[i].num=values[i].num-1;}this.setState({numObjs:this.state.numObjs-1},function(){return _this3.setState({listObjects:values,deleted:deletedObjs});});}},{key:\"onSubmit\",value:function onSubmit(){var imageFiles=new FormData();var listObjects=this.state.listObjects;listObjects.forEach(function(obj,index,objects){imageFiles.append('file',obj.imageFile);delete objects[index].imageFile;});axios.post(\"/upload/uploadImages\",imageFiles).then(function(res){// then print response status\nconsole.log(\"Image upload for page returned: \".concat(res.statusText));}).catch(function(err){return console.log(err);});var PageData={\"type\":this.state.type,\"title\":this.state.type,\"text\":\"\",\"objs\":listObjects,\"deleted\":this.state.deleted,\"id\":this.props.pageId};if(this.state.createPage){axios.post('/upload/uploadListPage',PageData).then(function(response){return alert(response.data);});}else{axios.post('/edit/editListPage',PageData).then(function(response){return alert(response.data);});};alert(\"Updated Page, refresh to see your changes\");}},{key:\"render\",value:function render(){var _this4=this;var create_inputs=this.state.listObjects.map(function(obj,index){return/*#__PURE__*/React.createElement(ListObjectEditor,{key:obj._id?obj._id:obj.keyValue,image:obj.imgName,num:obj.num,title:_this4.state.listObjects[index].title,blurb:_this4.state.listObjects[index].blurb,description:_this4.state.listObjects[index].description,updatePageObject:_this4.updatePageObject,removePageObject:_this4.removePageObject});});return/*#__PURE__*/React.createElement(\"div\",{className:\"pageEditor\"},/*#__PURE__*/React.createElement(BackButton,{backPage:this.props.backPage}),/*#__PURE__*/React.createElement(\"form\",{className:\"pageForm\"},create_inputs,/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"button\",onClick:this.addPageObject},\"Add new \",this.props.pageType),/*#__PURE__*/React.createElement(\"div\",{className:\"editSubmitButtons\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"editSubmitButton\",onClick:this.onSubmit},\" Submit \"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"editSubmitButton\",onClick:this.props.backPage},\"Cancel\"))));}}]);return ListPageTemplate;}(Component);export{ListPageTemplate as default};var ListObjectEditor=/*#__PURE__*/function(_Component2){_inherits(ListObjectEditor,_Component2);var _super2=_createSuper(ListObjectEditor);function ListObjectEditor(props){var _this5;_classCallCheck(this,ListObjectEditor);_this5=_super2.call(this,props);_this5.updateImage=function(file,name){_this5.setState({image:name});_this5.props.updatePageObject(_this5.props.num,\"imgName\",name);_this5.props.updatePageObject(_this5.props.num,\"imageFile\",file);};_this5.updateObject=function(event){if(event){_this5.setState(_defineProperty({},event.target.name,event.target.value));_this5.props.updatePageObject(_this5.props.num,event.target.name,event.target.value);}};_this5.state={image:_this5.props.image,title:_this5.props.title,blurb:_this5.props.blurb,description:_this5.props.description};_this5.updateImage=_this5.updateImage.bind(_assertThisInitialized(_this5));_this5.updateObject=_this5.updateObject.bind(_assertThisInitialized(_this5));return _this5;}_createClass(ListObjectEditor,[{key:\"render\",value:function render(){var _this6=this;return/*#__PURE__*/React.createElement(\"li\",{className:\"pageEditingObject\"},/*#__PURE__*/React.createElement(\"div\",{className:\"inputGroup\"},/*#__PURE__*/React.createElement(UploadImage,{currentImage:this.state.image,changeImage:this.updateImage})),/*#__PURE__*/React.createElement(\"div\",{className:\"inputGroup\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"title\",className:\"editingInput\",value:this.state.title,placeholder:\"Title\",onChange:this.updateObject})),/*#__PURE__*/React.createElement(\"div\",{className:\"inputGroup\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"blurb\",className:\"editingInput\",value:this.state.blurb,placeholder:\"SubTitle\",onChange:this.updateObject})),/*#__PURE__*/React.createElement(\"div\",{className:\"inputGroup\"},/*#__PURE__*/React.createElement(\"textarea\",{name:\"description\",className:\"editingInput descriptionInput\",value:this.state.description,placeholder:\"Description\",onChange:this.updateObject})),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",name:this.props.num,className:\"tooltip trashButton\",onClick:function onClick(index){return _this6.props.removePageObject(_this6.props.num);}},/*#__PURE__*/React.createElement(FaTrashAlt,null),/*#__PURE__*/React.createElement(\"span\",{className:\"tooltiptext\"},\"Remove this\")));}}]);return ListObjectEditor;}(Component);","map":{"version":3,"sources":["/Users/Steven/CS-Projects/portfolio-template/portfolioWebsite/client/src/App/admin/listPageTemplate.js"],"names":["React","Component","axios","BackButton","UploadImage","FaTrashAlt","ListPageTemplate","props","getPageData","pageId","get","params","pageType","then","response","setState","title","data","type","listObjects","childObjects","numObjs","length","state","createPage","deleted","onChange","bind","addPageObject","updatePageObject","removePageObject","onSubmit","event","target","name","value","values","push","keyValue","Date","getTime","num","index","field","deletedObjs","_id","splice","i","imageFiles","FormData","forEach","obj","objects","append","imageFile","post","res","console","log","statusText","catch","err","PageData","alert","create_inputs","map","imgName","blurb","description","backPage","ListObjectEditor","updateImage","file","image","updateObject"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport { BackButton, UploadImage } from 'src/App/admin/helperComponents';\nimport { FaTrashAlt } from \"react-icons/fa\";  // Font Awesome\nimport PropTypes from \"prop-types\";\n\nexport default class ListPageTemplate extends Component {\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.state ={\n\t\t\ttype:this.props.pageType,\n\t\t\ttitle:\"\",\n\t\t\tnumObjs:0,\n\t\t\tlistObjects:[],\n\t\t\tcreatePage:this.props.createPage,\n\t\t\tdeleted:[]\n\t\t}\n\t\tthis.onChange=this.onChange.bind(this);\n\t\tthis.getPageData=this.getPageData.bind(this);\n\t\tthis.addPageObject=this.addPageObject.bind(this);\n\t\tthis.updatePageObject=this.updatePageObject.bind(this);\n\t\tthis.removePageObject=this.removePageObject.bind(this);\n\t\tthis.onSubmit=this.onSubmit.bind(this);\n\t}\n\n\tonChange(event){\n\t\tthis.setState({[event.target.name]:event.target.value});\n\t}\n\t\n\tcomponentDidMount(){\n\t\tthis.getPageData();\n\t}\n\n    getPageData = () =>{\n    \tif (this.props.pageId){\n\t        axios.get('/api/getPage', { params: {pageId: this.props.pageId, pageType:\"list\" } })\n\t        .then((response) => {\n\t          this.setState({\n\t            title:response.data.title, \n\t            type:response.data.type, \n\t           \tlistObjects:response.data.childObjects, \n\t           \tnumObjs:response.data.childObjects.length\n\t            });\n\t        });\n\t    }\n    }\n\n\taddPageObject(event){\n\t    const values = [...this.state.listObjects];\n\t\tvalues.push({\"title\":\"\", \"blurb\":\"\", \"imgName\":\"\", \"description\":\"\", \n\t\t\tkeyValue:new Date().getTime(), num:this.state.numObjs});\n\t\tthis.setState({listObjects:values}, \n\t\t\t()=>this.setState({numObjs:this.state.numObjs+1}));\n\t}\n\n\tupdatePageObject(index, field, value){\n\t    const values = [...this.state.listObjects];\n\t    values[index][field]=value;\n\t\tthis.setState({listObjects:values});\n\t}\n\n\tremovePageObject(index){\n\t    const values = [...this.state.listObjects];\n\t    const deletedObjs = [...this.state.deleted];\n\t    deletedObjs.push(values[index]._id);\n\n\t    values.splice(index, 1);\n\t    for (var i=index; i<values.length; i++)\t{\n\t    \tvalues[i].num=values[i].num-1;\n\t    }\n\n\t   \tthis.setState({numObjs:this.state.numObjs-1},\n\t   \t\t()=>this.setState({listObjects:values, deleted:deletedObjs}));\n\t}\n\n\tonSubmit(){\n\t\tvar imageFiles = new FormData();\n\t\tvar listObjects = this.state.listObjects;\n\t\tlistObjects.forEach((obj, index, objects)=>{\n\t\t\timageFiles.append('file', obj.imageFile);\n\t\t\tdelete objects[index].imageFile;\n\t\t});\n\n\t    axios.post(\"/upload/uploadImages\", imageFiles).then(res => { // then print response status\n\t        console.log(`Image upload for page returned: ${res.statusText}`);\n\t    }).catch(err => console.log(err));\n\n\t\tconst PageData={\"type\":this.state.type, \"title\":this.state.type, \"text\":\"\",\n\t\t\t\"objs\":listObjects, \"deleted\":this.state.deleted, \"id\":this.props.pageId};\n\t\tif (this.state.createPage) { \n\t\t\taxios.post('/upload/uploadListPage', PageData).then((response)=>alert(response.data));\n\t\t} else {\n\t\t\taxios.post('/edit/editListPage', PageData).then((response)=>alert(response.data));\n\t\t};\n\t\talert(\"Updated Page, refresh to see your changes\");\n\t}\n\n\trender(){\n\t\tconst create_inputs = this.state.listObjects.map((obj, index) => \n\t\t     \t<ListObjectEditor key={obj._id ? obj._id : obj.keyValue} image={obj.imgName} num={obj.num} \n\t\t     \t\ttitle={this.state.listObjects[index].title} \n\t\t     \t\tblurb={this.state.listObjects[index].blurb}\n\t\t     \t\tdescription={this.state.listObjects[index].description}\n\t\t     \t\tupdatePageObject={this.updatePageObject}\n\t\t     \t\tremovePageObject={this.removePageObject}\n\t\t     \t/>\n\t\t     \n\t    );\n\n\t\treturn(\n\t\t<div className=\"pageEditor\">\n\t\t\t<BackButton backPage={this.props.backPage}/>\n\t\t\t<form className=\"pageForm\">\n\t\t\t\t{ create_inputs }\n\t\t\t\t<button type=\"button\" className=\"button\" onClick={this.addPageObject}> \n\t\t\t\t\tAdd new {this.props.pageType} \n\t\t\t\t</button>\n\t\t\t\t<div className=\"editSubmitButtons\">\n\t\t\t\t\t<button type=\"button\" className=\"editSubmitButton\" onClick={this.onSubmit}> Submit </button>\n\t\t\t\t\t<button type=\"button\" className=\"editSubmitButton\" onClick={this.props.backPage}>\n\t\t\t\t\t\tCancel \n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>)\n\t}\n}\n\nListPageTemplate.propTypes = {\n\tpageId:PropTypes.string,\n\tcratePage:PropTypes.string,\n\tpageType:PropTypes.string,\n\tbackPage:PropTypes.func.isRequired\n}\n\n\nclass ListObjectEditor extends Component {\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state={\n\t\t\timage:this.props.image,\n\t\t\ttitle:this.props.title,\n\t\t\tblurb:this.props.blurb,\n\t\t\tdescription:this.props.description\n\t\t}\n\t\tthis.updateImage=this.updateImage.bind(this);\n\t\tthis.updateObject=this.updateObject.bind(this);\n\t}\n\n\tupdateImage = (file, name) =>{\n\t\tthis.setState({image:name});\n\t\tthis.props.updatePageObject(this.props.num, \"imgName\", name);\n\t\tthis.props.updatePageObject(this.props.num, \"imageFile\", file);\n\t}\n\n\tupdateObject = (event) =>{\n\t\tif(event){\n\t\t\tthis.setState({[event.target.name]:event.target.value})\n\t\t\tthis.props.updatePageObject(this.props.num, event.target.name, event.target.value);\n\t\t}\n\t}\n\n\trender(){\n\n\t\treturn(\n\t \t\t<li className=\"pageEditingObject\">\n\t \t\t\t<div className=\"inputGroup\">\n\t\t\t\t\t<UploadImage currentImage={this.state.image} changeImage={this.updateImage} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"inputGroup\">\n\t\t\t\t\t<input type=\"text\" name=\"title\" className=\"editingInput\" value={this.state.title} placeholder=\"Title\" \n\t\t\t\t\t\tonChange={this.updateObject}/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"inputGroup\">\n\t\t\t\t\t<input type=\"text\" name=\"blurb\" className=\"editingInput\" value={this.state.blurb} placeholder=\"SubTitle\" \n\t\t\t\t\t\tonChange={this.updateObject}/>\n\t\t\t\t</div>\t\t\t\t\n\t\t\t\t<div className=\"inputGroup\">\n\t\t\t\t\t<textarea name=\"description\" className=\"editingInput descriptionInput\" value={this.state.description} placeholder=\"Description\" \n\t\t\t\t\t\tonChange={this.updateObject}/>\n\t\t\t\t</div>\n\t\t\t\t<button type=\"button\" name={this.props.num} className=\"tooltip trashButton\" \n\t\t\t\t\tonClick={index=>this.props.removePageObject(this.props.num)}>\n\t\t\t    \t<FaTrashAlt />\n\t\t\t\t    <span className=\"tooltiptext\">Remove this</span>\n\t\t\t\t</button>\n\t\t\t</li>\n\t\t)\n\t}\n}\n\nListObjectEditor.propTypes = {\n\tnum:PropTypes.number,\n\ttitle:PropTypes.string,\n\tblurb:PropTypes.string,\n\tdescription:PropTypes.string,\n\tremovePageObject:PropTypes.func\n}\n"]},"metadata":{},"sourceType":"module"}